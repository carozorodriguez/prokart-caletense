<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Karting | Campeonato Oficial</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@300;500;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --rojo: #e10600;
      --negro: #111;
      --gris: #f4f4f4;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: 'Oswald', Arial, sans-serif;
      background: var(--gris);
      color: #222;
    }
    header {
      background: #000;
      color: #fff;
      padding: 60px 20px;
      text-align: center;
    }
    header img {
      max-width: 320px;
      width: 90%;
      height: auto;
      margin-bottom: 20px;
    }
    header h1 { font-size: 3rem; margin: 0; }
    nav {
      position: sticky;
      top: 0;
      background: var(--negro);
      display: flex;
      justify-content: center;
      gap: 25px;
      padding: 15px;
      z-index: 10;
    }
    nav a {
      color: #fff;
      text-decoration: none;
      font-weight: 500;
      letter-spacing: 1px;
    }
    nav a:hover { color: var(--rojo); }
    section {
      padding: 60px 20px;
      max-width: 1100px;
      margin: auto;
    }
    h2 {
      font-size: 2rem;
      border-left: 6px solid var(--rojo);
      padding-left: 15px;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-top: 30px;
    }
    .card {
      background: #fff;
      padding: 25px;
      border-radius: 10px;
      box-shadow: 0 4px 10px rgba(0,0,0,.1);
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    table th, table td {
      padding: 12px;
      border-bottom: 1px solid #ddd;
    }
    table th {
      background: var(--negro);
      color: #fff;
      text-align: left;
    }
    button {
      margin-top: 25px;
      background: var(--rojo);
      color: #fff;
      border: none;
      padding: 14px;
      width: 100%;
      font-size: 1.1rem;
      cursor: pointer;
      border-radius: 6px;
    }
    button:hover { background: #b00400; }
    footer {
      background: var(--negro);
      color: #fff;
      text-align: center;
      padding: 30px 20px;
      margin-top: 60px;
    }
  </style>
</head>
<body>

<header>
  <img src="ProKart.jpg" alt="PROKART CALETENSE Logo">
  <h1>PROKART CALETENSE</h1>
  <p>Temporada Oficial 2026</p>
</header>

<nav>
  <a href="#categorias">Categorías</a>
  <a href="#fechas">Fechas</a>
  <a href="#posiciones">Resultados</a>
  <a href="#inscripcion">Inscripciones</a>
</nav>

<section id="categorias">
  <h2>Categorías</h2>

  <!-- PRE JUNIOR -->
  <div class="card">
    <h3>PRE JUNIOR</h3>
    <p><strong>Reglamento:</strong> Categoría formativa destinada a pilotos en etapa inicial. Chasis y motorización según reglamento PROKART CALETENSE vigente.</p>
    <a href="reglamentos/Reglamento_PRE_JUNIOR.pdf" target="_blank">
      <button type="button">Descargar Reglamento PDF</button>
    </a>
    <h4>Pilotos Rankeados</h4>
    <div class="grid">
      <div class="card">
        <img src="pilotos/prejunior_1.jpg" alt="Piloto PRE JUNIOR" style="width:100%; border-radius:8px;">
        <p>Nombre del Piloto</p>
      </div>
      <div class="card">
        <img src="pilotos/prejunior_2.jpg" alt="Piloto PRE JUNIOR" style="width:100%; border-radius:8px;">
        <p>Nombre del Piloto</p>
      </div>
    </div>
  </div>

  <!-- JUNIOR -->
  <div class="card">
    <h3>JUNIOR</h3>
    <p><strong>Reglamento:</strong> Categoría juvenil competitiva. Reglamentación técnica y deportiva PROKART CALETENSE.</p>
    <a href="reglamentos/Reglamento_JUNIOR.pdf" target="_blank">
      <button type="button">Descargar Reglamento PDF</button>
    </a>
    <h4>Pilotos Rankeados</h4>
    <div class="grid">
      <div class="card">
        <img src="pilotos/junior_1.jpg" alt="Piloto JUNIOR" style="width:100%; border-radius:8px;">
        <p>Nombre del Piloto</p>
      </div>
    </div>
  </div>

  <!-- 110 CAJEROS -->
  <div class="card">
    <h3>110 Cajeros</h3>
    <p><strong>Reglamento:</strong> Motores 110cc, preparación controlada, enfoque regional y competitivo.</p>
    <a href="reglamentos/Reglamento_110_Cajeros.pdf" target="_blank">
      <button type="button">Descargar Reglamento PDF</button>
    </a>
    <h4>Pilotos Rankeados</h4>
    <div class="grid"></div>
  </div>

  <!-- 200 MASTER -->
  <div class="card">
    <h3>200 Master</h3>
    <p><strong>Reglamento:</strong> Categoría para pilotos experimentados. Motores 200cc según reglamento oficial.</p>
    <a href="reglamentos/Reglamento_200_Master.pdf" target="_blank">
      <button type="button">Descargar Reglamento PDF</button>
    </a>
    <h4>Pilotos Rankeados</h4>
    <div class="grid"></div>
  </div>

  <!-- 200 STD -->
  <div class="card">
    <h3>200 STD</h3>
    <p><strong>Reglamento:</strong> Categoría estándar 200cc, igualdad mecánica y control técnico estricto.</p>
    <a href="reglamentos/Reglamento_200_STD.pdf" target="_blank">
      <button type="button">Descargar Reglamento PDF</button>
    </a>
    <h4>Pilotos Rankeados</h4>
    <div class="grid"></div>
  </div>
</section>

<section id="fechas">
  <h2>Calendario Regional</h2>
  <div class="grid">
    <div class="card">Fecha 1 – Caleta Olivia</div>
    <div class="card">Fecha 2 – Pico Truncado</div>
    <div class="card">Fecha 3 – Las Heras</div>
 <div class="card">Fecha 4 – Puerto Deseado</div>
<div class="card">Fecha 5 – Caleta Olivia</div>
<div class="card">Fecha 6 – Las Heras</div>
  <div class="card">Fecha 7 – Caleta Olivia</div>
<div class="card">Fecha 8 – Las Heras</div>
  </div>
</section>

<section id="posiciones">
  <h2>Resultados y Posiciones</h2>
  <p>Seleccioná la categoría y la fecha.</p>

  <label for="categoriaSelect">Categoría:</label>
  <select id="categoriaSelect"></select>

  <label for="fechaSelect">Fecha:</label>
  <select id="fechaSelect"></select>

  <h3>Resultados por Fecha</h3>
  <table id="tablaResultados">
    <thead>
      <tr><th>Puesto</th><th>Piloto</th><th>Puntos</th></tr>
    </thead>
    <tbody></tbody>
  </table>

  <h3>Tabla General</h3>
  <table id="tablaGeneral">
    <thead>
      <tr><th>Pos</th><th>Piloto</th><th>Total</th></tr>
    </thead>
    <tbody></tbody>
  </table>
</section>

<section id="inscripcion">
  <h2>Inscripciones</h2>
  <div class="card">
    <p>Las inscripciones oficiales se realizan mediante el formulario de Google correspondiente a cada fecha.</p>
    <a href="https://docs.google.com/forms" target="_blank">
      <button type="button">Ir al Formulario Oficial</button>
    </a>
  </div>
</section>

<footer>
  <p>© 2026  ProKart Caletense</p>
</footer>

<script>
/* ===============================
   CONFIGURACIÓN DE CATEGORÍAS
================================ */
const categorias = {
  "PRE JUNIOR": "https://docs.google.com/spreadsheets/d/e/2PACX-1vQFypnuhKrIq3bwVhehER3JFHbPukGhNGqrAqC2avomKgLPdu6C069biQFU5lAcJ3_6kt7Jntl4dre0/pub?gid=0&single=true&output=csv",
  "JUNIOR": "https://docs.google.com/spreadsheets/d/e/2PACX-1vQFypnuhKrIq3bwVhehER3JFHbPukGhNGqrAqC2avomKgLPdu6C069biQFU5lAcJ3_6kt7Jntl4dre0/pub?gid=1173158505&single=true&output=csv",
  "110 Cajeros": "https://docs.google.com/spreadsheets/d/e/2PACX-1vQFypnuhKrIq3bwVhehER3JFHbPukGhNGqrAqC2avomKgLPdu6C069biQFU5lAcJ3_6kt7Jntl4dre0/pub?gid=796482582&single=true&output=csv",
  "200 Master": "https://docs.google.com/spreadsheets/d/e/2PACX-1vQFypnuhKrIq3bwVhehER3JFHbPukGhNGqrAqC2avomKgLPdu6C069biQFU5lAcJ3_6kt7Jntl4dre0/pub?gid=2021979125&single=true&output=csv",
  "200 STD": "https://docs.google.com/spreadsheets/d/e/2PACX-1vQFypnuhKrIq3bwVhehER3JFHbPukGhNGqrAqC2avomKgLPdu6C069biQFU5lAcJ3_6kt7Jntl4dre0/pub?gid=660182728&single=true&output=csv"
};

let datos = [];

const categoriaSelect = document.getElementById('categoriaSelect');
const fechaSelect = document.getElementById('fechaSelect');

/* ===============================
   SELECT DE CATEGORÍAS
================================ */
Object.keys(categorias).forEach(cat => {
  const opt = document.createElement('option');
  opt.value = cat;
  opt.textContent = cat;
  categoriaSelect.appendChild(opt);
});

categoriaSelect.addEventListener('change', cargarCategoria);
fechaSelect.addEventListener('change', filtrarFecha);

/* ===============================
   CARGA INICIAL
================================ */
cargarCategoria();

/* ===============================
   FUNCIONES
================================ */
function cargarCategoria() {
  const categoria = categoriaSelect.value;
  const url = categorias[categoria];
  if (!url) return;

  fetch(url)
    .then(r => {
      if (!r.ok) throw new Error('No se pudo acceder al CSV');
      return r.text();
    })
    .then(text => {
      const filas = text.replace(/\r/g,'').trim().split('\n');
      datos = filas.slice(1).map(f => {
        const c = f.split(',').map(v => v.replace(/^"|"$/g,'').trim());
        return {
          fecha: c[0],
          piloto: c[1],
          puesto: Number(c[2]) || 0,
          puntos: Number(c[3]) || 0
        };
      }).filter(d => d.piloto);

      cargarFechas();
      cargarGeneral();
      cargarPilotosRankeados(categoria);
    })
    .catch(err => {
      console.error(err);
      alert('Error cargando datos de la categoría');
    });
}

function cargarFechas() {
  fechaSelect.innerHTML = '';
  [...new Set(datos.map(d => d.fecha))].forEach(f => {
    const opt = document.createElement('option');
    opt.value = f;
    opt.textContent = f;
    fechaSelect.appendChild(opt);
  });
  filtrarFecha();
}

function filtrarFecha() {
  const body = document.querySelector('#tablaResultados tbody');
  body.innerHTML = '';
  datos
    .filter(d => d.fecha === fechaSelect.value)
    .forEach(d => {
      const row = document.createElement('tr');
      row.innerHTML = `<td>${d.puesto}</td><td>${d.piloto}</td><td>${d.puntos}</td>`;
      body.appendChild(row);
    });
}

function cargarGeneral() {
  const body = document.querySelector('#tablaGeneral tbody');
  body.innerHTML = '';
  const mapa = {};

  datos.forEach(d => {
    mapa[d.piloto] = (mapa[d.piloto] || 0) + d.puntos;
  });

  Object.entries(mapa)
    .sort((a, b) => b[1] - a[1])
    .forEach((item, index) => {
      const row = document.createElement('tr');
      row.innerHTML = `<td>${index + 1}</td><td>${item[0]}</td><td>${item[1]}</td>`;
      body.appendChild(row);
    });
}

/* ===============================
   PILOTOS RANKEADOS EN CATEGORÍAS
================================ */
function cargarPilotosRankeados(categoria) {
  const card = [...document.querySelectorAll('#categorias .card')]
    .find(c => c.querySelector('h3')?.textContent === categoria);

  if (!card) return;

  const grid = card.querySelector('.grid');
  if (!grid) return;

  grid.innerHTML = '';

  const ranking = {};
  datos.forEach(d => {
    ranking[d.piloto] = (ranking[d.piloto] || 0) + d.puntos;
  });

  Object.entries(ranking)
    .sort((a, b) => b[1] - a[1])
    .forEach(([piloto, puntos], index) => {
      const div = document.createElement('div');
      div.className = 'card';
      div.innerHTML = `
        <img src="pilotos/${piloto.replaceAll(' ','_')}.jpg"
             onerror="this.src='pilotos/default.jpg'"
             style="width:100%;border-radius:8px;">
        <p><strong>#${index + 1} ${piloto}</strong><br>${puntos} pts</p>
        <a href="piloto.html?piloto=${encodeURIComponent(piloto)}&categoria=${encodeURIComponent(categoria)}">
          Ver ficha
        </a>
      `;
      grid.appendChild(div);
    });
}
</script>

